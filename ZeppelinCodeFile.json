{"paragraphs":[{"text":"// Cargamos el archivo csv en un dataframe\nval df = spark.read.format(\"csv\").option(\"delimiter\",\",\").load(\"file:///home/keepcoding/amigos.csv\")\n// Mostramos el schema para comprobar que se ha cargado correctamente\ndf.printSchema()","user":"anonymous","dateUpdated":"2020-02-02T13:08:43+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _c0: string (nullable = true)\n |-- _c1: string (nullable = true)\n |-- _c2: string (nullable = true)\n |-- _c3: string (nullable = true)\n\ndf: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579975653675_1025017224","id":"20200125-190733_1592840933","dateCreated":"2020-01-25T19:07:33+0100","dateStarted":"2020-02-02T13:08:43+0100","dateFinished":"2020-02-02T13:08:44+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1828"},{"text":"// Podríamos ver el número de registros directamente sobre el dataframe\nprintln(df.count())","user":"anonymous","dateUpdated":"2020-02-02T13:08:47+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"500\n"}]},"apps":[],"jobName":"paragraph_1580154462187_1550520123","id":"20200127-204742_2013875619","dateCreated":"2020-01-27T20:47:42+0100","dateStarted":"2020-02-02T13:08:47+0100","dateFinished":"2020-02-02T13:08:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1829"},{"text":"// También podemos trabajar como si fuera una base de datos sql\n// Creamos la vista temporal para realizar el conteo\ndf.createOrReplaceTempView(\"amigos\")\n// Realizamos y guaramos la consulta en una variable inmutable\nval total_amigos = spark.sql(\"select count(*) from amigos\")","user":"anonymous","dateUpdated":"2020-02-02T13:08:50+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"total_amigos: org.apache.spark.sql.DataFrame = [count(1): bigint]\n"}]},"apps":[],"jobName":"paragraph_1579975733123_1857243527","id":"20200125-190853_1828864447","dateCreated":"2020-01-25T19:08:53+0100","dateStarted":"2020-02-02T13:08:50+0100","dateFinished":"2020-02-02T13:08:51+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1830"},{"text":"// Mostramos el total de amigos contenido en la variable\ntotal_amigos.show()","user":"anonymous","dateUpdated":"2020-02-02T13:08:54+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|     500|\n+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1579975833922_-2095504909","id":"20200125-191033_1120711635","dateCreated":"2020-01-25T19:10:33+0100","dateStarted":"2020-02-02T13:08:54+0100","dateFinished":"2020-02-02T13:08:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1831"},{"user":"anonymous","dateUpdated":"2020-01-25T19:37:36+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579975850394_233580932","id":"20200125-191050_147889931","dateCreated":"2020-01-25T19:10:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1832"}],"name":"ZeppelinCodeFile","id":"2F1J7KB74","noteParams":{},"noteForms":{},"angularObjects":{"spark2:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}